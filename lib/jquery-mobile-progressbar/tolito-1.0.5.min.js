/*! Copyright 2013 jQuery Foundation and other contributors - Released under the MIT license. - jquery.org/license !*/(function(a,b){a.widget("mobile.progressbar",{options:{outerTheme:null,innerTheme:null,mini:false,value:0,max:100,counter:true,indefinite:false},min:0,_create:function(){var h=this.element,g=a.mobile.getInheritedTheme(h,"c"),c=this.options.outerTheme||g,e=this.options.indefinite?"indefinite":this.options.innerTheme||g,f=this.options.mini?" ui-tolito-progressbar-mini":"",d=this.options.counter;this.element.addClass(["ui-tolito-progressbar "," ui-tolito-progressbar-outer-",c," ui-tolito-progressbar-corner-all",f].join("")).attr({role:"progressbar","min-value":this.min,"max-value":this.options.max,"content-value":this._value()});if(d&&!this.options.indefinite){this.labelContent=(a("<div></div>").text(this._value()).addClass("ui-tolito-progressbar-label ui-tolito-progressbar-corner-all")).appendTo(this.element)}this.valueContent=(a("<div></div>").addClass(["ui-tolito-progressbar-bg "," ui-tolito-progressbar-active-",e," ui-tolito-progressbar-corner-all"].join(""))).appendTo(this.element);if(!this.options.indefinite){this._refreshValue();this.oldValue=this._value()}},_destroy:function(){this.element.removeClass().removeAttr("role").removeAttr("min-value").removeAttr("max-value").removeAttr("content-value");if((typeof this.labelContent!=="undefined")){this.labelContent.remove()}this.valueContent.remove()},value:function(c){if(c===b){return this._value()}this._setOption("value",c);return this},_setOption:function(c,d){this.options.value=d;if(c==="value"){this._refreshValue();if(this._value()===this.options.max){this.element.trigger("complete")}}},_value:function(){var c=this.options.value;if(typeof c!=="number"){c=0}return Math.min(this.options.max,Math.max(this.min,c))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var c=this.value();this.oldValue=c;this.valueContent.css("width",[this._percentage(),"%"].join(""));if((typeof this.labelContent!=="undefined")){this.labelContent.text([parseInt(this._percentage()),"%"].join(""))}this.element.attr("content-value",c)}});TolitoConstructor=function(c){if(c===b){throw"[Error]: Tolito element id is undefined"}this._id=c;this._defaultOuterTheme=null;this._defaultInnerTheme=null;this._defaultMax=100;this._defaultStartFrom=0;this._defaultInterval=100;this._isBuilt=false;this._mini=false;this._isRunning=false;this._indefinite=false;return this};TolitoProgressBar=function(c){return new TolitoConstructor(c)};TolitoConstructor.prototype={logOptions:function(){((typeof console==="undefined")?{log:function(){}}:console).log(["id: '",this.getId(),"' outerTheme: '",this.getOuterTheme(),"' innerTheme: '",this.getInnerTheme(),"' max: '",this.getMax(),"' mini: '",this.getMini(),"' startFrom: '",this.getStartFrom(),"' interval: '",this.getInterval(),"' showCounter: '",this.getShowCounter(),"'","' indefinite: '",this.getIndefinite(),"'"].join(""));return this},getId:function(){return this._id},setOuterTheme:function(c){if(this._isBuilt){throw"[Error]: Tolito is already built."}else{this._outerTheme=c;return this}},getOuterTheme:function(){return this._outerTheme||this._defaultOuterTheme},setInnerTheme:function(c){if(this._isBuilt){throw"[Error]: Tolito is already built."}else{this._innerTheme=c;return this}},getInnerTheme:function(){return this._innerTheme||this._defaultInnerTheme},setStartFrom:function(c){if(this._isBuilt){throw"[Error]: Tolito is already built."}else{this._startFrom=c;return this}},getStartFrom:function(){return this._startFrom||this._defaultStartFrom},setMax:function(c){if(this._isBuilt){throw"[Error]: Tolito is already built."}else{this._max=c;return this}},getMax:function(){return this._max||this._defaultMax},isMini:function(c){if(this._isBuilt){throw"[Error]: Tolito is already built."}else{this._mini=c;return this}},getMini:function(){return this._mini},isIndefinite:function(c){if(this._isBuilt){throw"[Error]: Tolito is already built."}else{this._indefinite=c;return this}},getIndefinite:function(){return this._indefinite},showCounter:function(c){if(this._isBuilt){throw"[Error]: Tolito is already built."}else{this._showCounter=c;return this}},getShowCounter:function(){return this._showCounter},setInterval:function(c){if(this._isBuilt){throw"[Error]: Tolito is already built."}else{this._interval=c;return this}},getInterval:function(){return this._interval||this._defaultInterval},build:function(){if(this._isBuilt){throw"[Error]: Tolito is already built."}else{a(["#",this.getId()].join("")).progressbar({outerTheme:this.getOuterTheme(),innerTheme:this.getInnerTheme(),value:this.getStartFrom(),max:this.getMax(),mini:this.getMini(),indefinite:this.getIndefinite(),counter:this.getShowCounter()});this._isBuilt=true;return this}},run:function(){if(this._isRunning){throw"[Error]: Tolito is already running."}else{if(this._indefinite){throw"[Error]: Tolito is indefinite."}else{(function c(d){d.fillProgressBar=setTimeout((function(e){return function(){var g=a(["#",e.getId()].join("")).progressbar("option","value"),f=!isNaN(g)?(g+1):1;if(f>e.getMax()){clearTimeout(e.fillProgressBar)}else{a(["#",e.getId()].join("")).progressbar({value:f});c(e)}}})(d),d.getInterval())})(this);this._isRunning=true;return this}}},stop:function(){if(!this._isRunning){throw"[Error]: Tolito is already stopped."}else{clearTimeout(this.fillProgressBar);this._isRunning=false;return this}},setValue:function(c){if(this._indefinite){throw"[Error]: Tolito is indefinite."}else{a(["#",this.getId()].join("")).progressbar({value:c});return this}},destroy:function(){if(!this._isBuilt){throw"[Error]: Tolito is not built yet."}else{if(this.fillProgressBar){clearTimeout(this.fillProgressBar)}a(document).off("complete",["#",this.getId()].join(""));a(["#",this.getId()].join("")).progressbar("destroy");return null}}}})(jQuery);
